<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>IBC Accelerator 2025</title>
    <meta name="viewport" content="width=device-width, user-scalable=yes, initial-scale=1">
    <script src="https://shaka-project.github.io/shaka-player/dist/shaka-player.ui.js"></script>
    <link rel="stylesheet" href="https://shaka-project.github.io/shaka-player/dist/controls.css">
    <link href="./bootstrap.min.css" rel="stylesheet">
    <style>
      video {
        width: 100%;
      }

      .company-logos{
        display: flex;
        justify-content: space-evenly;
        align-items: center;
        flex-wrap: wrap;
        flex-direction: row;
      }

      .margin-top-row {
        margin-top: 10px;
      }
    </style>
    <script>
      async function getPlayer(videoContainer, video) {
        const localPlayer = new shaka.Player();
        await localPlayer.attach(video);
        const ui = new shaka.ui.Overlay(localPlayer, videoContainer, video);
        const controls = ui.getControls();
        const player = controls.getPlayer();
        ui.configure({
          customContextMenu: true,
        });

        const languages = navigator.languages || ['en-us'];
        player.configure({
          manifest: {
            dash:{
              clockSyncUri: 'https://time.akamai.com/?ms&iso',
            },
          },
          streaming: {
            bufferingGoal: 30,
            bufferBehind: 30,
            minTimeBetweenRecoveries: 1,
            liveSync: {
              enabled: true,
              targetLatency: 0,
              targetLatencyTolerance: 0.5,
            },
          },
          preferredAudioLanguage: languages[0],
          preferredTextLanguage: languages[0],
        });

        return player;
      }
      async function init() {
        shaka.polyfill.installAll();
        if (!shaka.Player.isBrowserSupported()) {
          alert('Browser not supported!');
          return;
        }
        const videoContainer = document.getElementById('video-container');
        const video = document.getElementById('video');
        const player = await getPlayer(videoContainer, video);

        const altVideoContainer = document.getElementById('video-container2');
        const altVideo = document.getElementById('video2');
        const altPlayer = await getPlayer(altVideoContainer, altVideo);

        const loadButton = document.getElementById('load-button');
        const urlSelect = document.getElementById('url-select');
        const customUrl = document.getElementById('custom-url');

        urlSelect.addEventListener('change', () => {
          if (urlSelect.value === 'custom') {
            customUrl.disabled = false;
            customUrl.value = '';
          } else {
            customUrl.value = urlSelect.value;
            customUrl.disabled = true;
          }
        });

        loadButton.addEventListener('click', () => {
          const enteredUrl = customUrl.value.trim();
          const selectedUrl = urlSelect.value;
          const mainUrl = enteredUrl !== '' ? enteredUrl : selectedUrl;
          player.load(mainUrl).then(() => {
            video.play();
          }).catch((error) => {
            console.error('Error loading asset:', mainUrl, error);
          });
          const originalUrl = urlSelect.selectedOptions[0].getAttribute('original');
          if (originalUrl) {
            altVideoContainer.style.display = '';
            altPlayer.load(originalUrl).then(() => {
              altVideo.play();
            }).catch((error) => {
              console.error('Error loading alt asset:', originalUrl, error);
            });
          } else {
            altVideoContainer.style.display = 'none';
            altPlayer.unload();
          }
        });
      }
      document.addEventListener('DOMContentLoaded', init)
    </script>
  </head>
  <body>
    <main>
      <div class="container py-4">
        <header class="pb-3 mb-4 margin-top-row">
          <h3>
            <a href="./index.html">
              <img src="../assets/ibc.png" width="80">
            </a>
            <b>Accelerator 2025</b>
          </h3>
        </header>
        <div class="row margin-top-row">
          <div class="col-md-12">
            <div class="h-100 p-5 border rounded-3">
              <div class="input-group">
                <button id="load-button" type="button" class="btn btn-primary" aria-haspopup="true" aria-expanded="false">Load</button>
                <select id="url-select" class="dropdown-toggle">
                  <option value="custom">Custom</option>
                  <option value="https://euw3-l3d-atri.akamaized.net/composer/channels/e8204695-5957-49f1-8da1-827282944612/manifest.mpd"
                      original="https://euw3-l3d-atri.akamaized.net/live/database/ull_l3d/DASH/ull_l3d.mpd">
                    L3-DASH interstitial
                  </option>
                  <option value="https://euw3-l3d-atri.akamaized.net/composer/channels/91f78bfb-9329-4aaa-a4df-b12176f2ddb2/manifest.mpd"
                      original="https://euw3-l3d-atri.akamaized.net/live/database/ull_l3d/DASH/ull_l3d.mpd">
                    L3-DASH overlay
                  </option>
                  <option value="https://euw3-l3d-atri.akamaized.net/composer/channels/3d355e75-abda-48f2-8a54-c392006ec615/manifest.mpd"
                      original="https://euw3-l3d-atri.akamaized.net/live/database/ull/DASH/ull.mpd">
                    LL-DASH interstitial
                  </option>
                  <option value="https://euw3-l3d-atri.akamaized.net/composer/channels/f76931fd-1937-433b-a06a-32560dc0ed8b/manifest.mpd"
                      original="https://euw3-l3d-atri.akamaized.net/live/database/ull/DASH/ull.mpd">
                    LL-DASH overlay
                  </option>
                  <option value="https://ll-euw3-neadai-atri.akamaized.net/composer/channels/a55ed328-03c6-4702-898d-a846b5873374/master-playlist.m3u8"
                      original="https://ll-euw3-neadai-atri.akamaized.net/origin/live/disk/dai/hls_fmp4_ll/dai.m3u8">
                    LL-HLS interstitial
                  </option>
                  <option value="https://ll-euw3-neadai-atri.akamaized.net/composer/channels/efd075d2-5c91-4cda-97a4-a44a11d29ee5/master-playlist.m3u8"
                      original="https://ll-euw3-neadai-atri.akamaized.net/origin/live/disk/dai/hls_fmp4_ll/dai.m3u8">
                    LL-HLS overlay
                  </option>
                </select>
                <input id="custom-url" type="text" class="form-control" placeholder="Paste your own URL here">
              </div>
              <div class="margin-top-row">
                <div id="video-container">
                  <video id="video" autoplay playsinline poster="../assets/ateme_poster.jpeg"></video>
                </div>
              </div>
              <div class="margin-top-row">
                <div id="video-container2" style="display: none;">
                  <video id="video2" autoplay playsinline muted></video>
                </div>
              </div>
            </div>
          </div>
        </div>
        <footer class="pt-3 mt-4 text-muted">
          <div class="company-logos">
            <img src="../assets/ateme.png" width="100">
            <img src="../assets/bbc.png" width="100">
            <img src="../assets/bt.png" width="60">
            <img src="../assets/comcast.png" width="110">
            <img src="../assets/elecard.png" width="130">
            <img src="../assets/gcloud.png" width="140">
            <img src="../assets/qualabs.png" width="130">
            <img src="../assets/rte.png" width="70">
            <img src="../assets/yospace.png" width="140">
          </div>
        </footer>
      </div>
    </main>
  </body>
</html>